{{ define "main" }}

{{ $dateMachine := .Lastmod | time.Format "2006-01-02T15:04:05-07:00" }}
{{ $dateHuman := .Lastmod | time.Format "02.01.2006" }}

{{ $pagefindBody := "" }}
{{ $pagefindBody := "data-pagefind-body" }}

{{ if and (isset .Params "hidden") .Params.hidden }}
    {{ $pagefindBody := "" }}
{{ end }}

<article {{ $pagefindBody | safeHTMLAttr }} class="rounded m-2 py-2 px-3 shadow" style="background-color: var(--bs-body-bg);"
    id="mainContent">
    {{ range .Params.categories }}
    <meta data-pagefind-filter="{{ T " theme.search.category" }}[content]" content="{{ . }}">
    {{ end }}

    <h1 data-pagefind-meta="title">{{ .Title }}</h1>

    <span 
        class="badge text-bg-secondary me-1 mb-2 d-inline-flex align-items-center gap-1" 
        data-bs-toggle="tooltip"
        data-bs-placement="bottom" 
        title="{{ T "theme.tags.lastmod" }}" 
        aria-label="{{ T "theme.tags.lastmod" }}">
        {{ partial "svg.html" "icons/outline/clock-edit.svg" }}

        <time data-pagefind-sort="date[datetime]" datetime="{{ $dateMachine }}">{{ $dateHuman}}</time>
    </span>

    {{ if .Draft }}
        <span class="badge text-bg-info me-1 mb-2 d-inline-flex align-items-center gap-1">
            {{ partial "svg.html" "icons/outline/edit.svg" }}
            
            {{ T "theme.tags.draft"}}
        </span>
    {{ end }}
    
    {{ if .Params.hidden }}
        <span class="badge text-bg-danger me-1 mb-2 d-inline-flex align-items-center gap-1">
            {{ partial "svg.html" "icons/outline/ghost.svg" }}
            
            {{ T "theme.tags.hidden"}}
        </span>
    {{ end }}

    <p>
        {{ .Content }}
    </p>
</article>

<div class="d-flex bd-highlight mb-3">
    {{ with .PrevInSection }}
        <a class="icon-link me-auto p-2" href="{{ .RelPermalink }}">
            {{ partial "svg.html" "icons/outline/arrow-narrow-left.svg"}}
            Previous
        </a>
    {{ else }}
        <div class="me-auto"></div>
    {{ end }}

    {{ with .NextInSection }}
        <a class="icon-link p-2" href="{{ .RelPermalink }}">
            Next
                {{ partial "svg.html" "icons/outline/arrow-narrow-right.svg"}}
        </a>
    {{ else }}
        <div></div>
    {{ end }}
</div>

<script>
    patch_markdown_tables("mainContent")
</script>

{{ end }}
