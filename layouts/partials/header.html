{{ $logoDimension := 76}}
{{/* <script src="/pagefind/pagefind.js" type="text/javascript"></script> */}}
<script>
    search();
    var pagefind;
    async function search() {
        pagefind = await import("/pagefind/pagefind.js");
        const inputElement = document.getElementById("search");
        inputElement.addEventListener('input', async (e) => {
            pagefind.preload(e.target.value);
            const search = await pagefind.debouncedSearch(e.target.value, {
                sort: {
                    date: "desc"
                }
            }, 300);
            var search_results = document.getElementById("results");
            if (search === null) {
                // a more recent search call has been made, nothing to do
            } else {
                if (search.results.length === 0) {
                    search_results.style.display = "none";
                    return;
                }
                search_results.style.display = "block";
                const fiveResults = await Promise.all(search.results.slice(0, 5).map(r => r.data()));
                console.log(fiveResults);
                search_results.innerHTML = "";
                for (let i = 0; i < fiveResults.length; i++) {
                    var a = document.createElement("a");
                    a.href = fiveResults[i].url;
                    a.innerHTML = fiveResults[i].meta.title;
                    var content = document.createElement("p");
                    content.innerHTML = fiveResults[i].excerpt;
                    search_results.appendChild(a);
                    search_results.appendChild(content);
                }
                search_results.appendChild(sr);
                return fiveResults;
            }
        })
    }
    init();
    function init() {
        var element = document.getElementById("theme");
        if (document.cookie.includes("theme=dark")) {
            element.setAttribute("data-bs-theme", "dark");
        } else {
            element.setAttribute("data-bs-theme", "light");
        }
    }


    function toggle_dark_mode() {
        document.cookie = "theme=light";
        var element = document.getElementById("theme");
        if (element.getAttribute("data-bs-theme") == "light") {
            element.setAttribute("data-bs-theme", "dark");
            document.cookie = "theme=dark; path=/";
        } else {
            element.setAttribute("data-bs-theme", "light");
            document.cookie = "theme=light' path=/";
        }
    }

</script>
<div class="shadow-sm">
    <div class="container-xl mt-2" style="border-bottom-width: 1px;">
        <div class="row d-flex">
            <div class="col-4 col-sm-7 col-xl d-sm-flex d-xl-flex align-items-sm-center align-items-xl-center">
                {{ with resources.Get "images/logo.png" }}
                    <img src="{{ .RelPermalink }}" width="{{ $logoDimension }}" height="{{ $logoDimension }}" onclick="toggle_menu()">
                {{ end }}
                <a class="navbar-brand text-start d-none d-sm-inline align-items-center">
                    <span class="text-capitalize fs-4 me-2">{{ .Site.Title }}</span>
                </a>
            </div>
            <div class="col-8 col-sm-5 col-xl-4 d-flex d-xl-flex justify-content-end align-items-center align-items-sm-center justify-content-xl-end align-items-xl-center">
                <div class="input-group">
                    <input id="search" type="search" class="form-control" name="Search" placeholder="Search...">
                        <span class="input-group-text">
                            {{ partial "svg.html" "icons/search.svg"}}
                        </span>
                        <button class="btn" type="submit" onclick="toggle_dark_mode()">
                            {{ partial "svg.html" "icons/moon.svg"}}
                        </button>
                        <div id="results" style="
                                position: fixed;
                                display: none;
                                top: 5em;
                                right: 15px;
                                border: 3px solid #f1f1f1;
                                z-index: 9;
                                color: black;
                                width: 20%;
                                max-height: 50vh;
                                overflow-y: auto;
                                background-color: white;">
                        </div>
                </div>
            </div>
        </div>
    </div>
</div>
